<Window x:Class="WeldAdminPro.UI.Views.ProjectDetailsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Project Details"
        Width="600"
        Height="820"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize">

	<ScrollViewer VerticalScrollBarVisibility="Auto">
		<Grid Margin="20">

			<!-- ================= MAIN ROWS ================= -->
			<Grid.RowDefinitions>
				<RowDefinition Height="Auto"/>
				<!-- Header -->
				<RowDefinition Height="Auto"/>
				<!-- Form -->
				<RowDefinition Height="Auto"/>
				<!-- Buttons -->
				<RowDefinition Height="Auto"/>
				<!-- Issue Stock -->
				<RowDefinition Height="Auto"/>
				<!-- Issued Stock History -->
			</Grid.RowDefinitions>

			<!-- ================= HEADER ================= -->
			<Grid Grid.Row="0" Margin="0,0,0,20">
				<Grid.ColumnDefinitions>
					<ColumnDefinition Width="120"/>
					<ColumnDefinition Width="*"/>
					<ColumnDefinition Width="120"/>
					<ColumnDefinition Width="*"/>
				</Grid.ColumnDefinitions>

				<TextBlock Text="Job Number" FontWeight="Bold"/>
				<TextBox Grid.Column="1"
                         Text="{Binding Project.JobNumber}"
                         IsReadOnly="True"
                         Background="#EEE"/>

				<TextBlock Grid.Column="2" Text="Status" FontWeight="Bold"/>
				<ComboBox Grid.Column="3"
                          ItemsSource="{Binding Statuses}"
                          SelectedItem="{Binding Status, Mode=TwoWay}"
                          Height="28"/>
			</Grid>

			<!-- ================= FORM ================= -->
			<Grid Grid.Row="1">
				<Grid.ColumnDefinitions>
					<ColumnDefinition Width="120"/>
					<ColumnDefinition Width="*"/>
					<ColumnDefinition Width="20"/>
					<ColumnDefinition Width="120"/>
					<ColumnDefinition Width="*"/>
				</Grid.ColumnDefinitions>

				<Grid.RowDefinitions>
					<RowDefinition Height="Auto"/>
					<RowDefinition Height="Auto"/>
					<RowDefinition Height="Auto"/>
					<RowDefinition Height="Auto"/>
					<RowDefinition Height="Auto"/>
					<RowDefinition Height="Auto"/>
					<RowDefinition Height="Auto"/>
					<RowDefinition Height="Auto"/>
					<!-- Invoice -->
				</Grid.RowDefinitions>

				<TextBlock Grid.Row="0" Grid.Column="0" Text="Project Name" FontWeight="Bold"/>
				<TextBox Grid.Row="0" Grid.Column="1" Grid.ColumnSpan="4"
                         Text="{Binding Project.ProjectName}"
                         IsEnabled="{Binding IsEditable}"/>

				<TextBlock Grid.Row="1" Grid.Column="0" Text="Client" FontWeight="Bold" Margin="0,8,0,0"/>
				<TextBox Grid.Row="1" Grid.Column="1" Grid.ColumnSpan="4"
                         Margin="0,8,0,0"
                         Text="{Binding Project.Client}"
                         IsEnabled="{Binding IsEditable}"/>

				<TextBlock Grid.Row="2" Grid.Column="0" Text="Client Rep" FontWeight="Bold" Margin="0,8,0,0"/>
				<TextBox Grid.Row="2" Grid.Column="1" Grid.ColumnSpan="4"
                         Margin="0,8,0,0"
                         Text="{Binding Project.ClientRepresentative}"
                         IsEnabled="{Binding IsEditable}"/>

				<TextBlock Grid.Row="3" Grid.Column="0" Text="Quote #" FontWeight="Bold" Margin="0,8,0,0"/>
				<TextBox Grid.Row="3" Grid.Column="1"
                         Margin="0,8,0,0"
                         Text="{Binding Project.QuoteNumber}"
                         IsEnabled="{Binding IsEditable}"/>

				<TextBlock Grid.Row="3" Grid.Column="3" Text="Order #" FontWeight="Bold" Margin="0,8,0,0"/>
				<TextBox Grid.Row="3" Grid.Column="4"
                         Margin="0,8,0,0"
                         Text="{Binding Project.OrderNumber}"
                         IsEnabled="{Binding IsEditable}"/>

				<TextBlock Grid.Row="4" Grid.Column="0" Text="Amount (R)" FontWeight="Bold" Margin="0,8,0,0"/>
				<TextBox Grid.Row="4" Grid.Column="1"
                         Margin="0,8,0,0"
                         Text="{Binding Project.Amount}"
                         IsEnabled="{Binding IsEditable}"/>

				<TextBlock Grid.Row="5" Grid.Column="0" Text="Material" FontWeight="Bold" Margin="0,8,0,0"/>
				<TextBox Grid.Row="5" Grid.Column="1"
                         Margin="0,8,0,0"
                         Text="{Binding Project.Material}"
                         IsEnabled="{Binding IsEditable}"/>

				<TextBlock Grid.Row="5" Grid.Column="3" Text="Assigned To" FontWeight="Bold" Margin="0,8,0,0"/>
				<TextBox Grid.Row="5" Grid.Column="4"
                         Margin="0,8,0,0"
                         Text="{Binding Project.AssignedTo}"
                         IsEnabled="{Binding IsEditable}"/>

				<TextBlock Grid.Row="6" Grid.Column="0" Text="Start Date" FontWeight="Bold" Margin="0,8,0,0"/>
				<DatePicker Grid.Row="6" Grid.Column="1"
                            Margin="0,8,0,0"
                            SelectedDate="{Binding Project.StartDate}"
                            IsEnabled="{Binding IsEditable}"/>

				<TextBlock Grid.Row="6" Grid.Column="3" Text="End Date" FontWeight="Bold" Margin="0,8,0,0"/>
				<DatePicker Grid.Row="6" Grid.Column="4"
                            Margin="0,8,0,0"
                            SelectedDate="{Binding Project.EndDate}"
                            IsEnabled="{Binding IsEditable}"/>

				<!-- ================= INVOICING ================= -->
				<CheckBox Grid.Row="7" Grid.Column="0"
                          Content="Invoiced"
                          Margin="0,12,0,0"
                          IsChecked="{Binding Project.IsInvoiced}"
                          IsEnabled="{Binding IsEditable}"/>

				<TextBox Grid.Row="7" Grid.Column="1" Grid.ColumnSpan="4"
                         Margin="0,12,0,0"
                         Text="{Binding Project.InvoiceNumber}"
                         IsEnabled="{Binding Project.IsInvoiced}"/>
			</Grid>

			<!-- ================= BUTTONS ================= -->
			<StackPanel Grid.Row="2"
                        Orientation="Horizontal"
                        HorizontalAlignment="Right"
                        Margin="0,30,0,0">
				<Button Content="Save"
                        Width="100"
                        Margin="0,0,10,0"
                        Command="{Binding SaveCommand}"/>
				<Button Content="Cancel"
                        Width="100"
                        Command="{Binding CancelCommand}"/>
			</StackPanel>

			<!-- ================= ISSUE STOCK ================= -->
			<GroupBox Grid.Row="3"
                      Header="Issue Stock to Project"
                      Margin="0,30,0,0">

				<Grid Margin="10">
					<Grid.ColumnDefinitions>
						<ColumnDefinition Width="120"/>
						<ColumnDefinition Width="*"/>
					</Grid.ColumnDefinitions>

					<Grid.RowDefinitions>
						<RowDefinition Height="Auto"/>
						<RowDefinition Height="Auto"/>
						<RowDefinition Height="Auto"/>
						<RowDefinition Height="Auto"/>
					</Grid.RowDefinitions>

					<TextBlock Grid.Row="0" Grid.Column="0" Text="Stock Item"/>
					<ComboBox Grid.Row="0" Grid.Column="1"
                              ItemsSource="{Binding StockItems}"
                              SelectedItem="{Binding SelectedStockItem}"
                              DisplayMemberPath="Description"
                              IsEnabled="{Binding IsEditable}"/>

					<TextBlock Grid.Row="1" Grid.Column="0" Text="Quantity" Margin="0,8,0,0"/>
					<TextBox Grid.Row="1" Grid.Column="1"
                             Margin="0,8,0,0"
                             Text="{Binding IssueQuantity}"
                             IsEnabled="{Binding IsEditable}"/>

					<TextBlock Grid.Row="1" Grid.Column="1"
                               Margin="0,30,0,0"
                               Foreground="Gray"
                               Text="{Binding AvailableQuantity, StringFormat=Available: {0}}"/>

					<TextBlock Grid.Row="2" Grid.Column="0" Text="Issued By" Margin="0,8,0,0"/>
					<TextBox Grid.Row="2" Grid.Column="1"
                             Margin="0,8,0,0"
                             Text="{Binding IssuedBy}"
                             IsEnabled="{Binding IsEditable}"/>

					<Button Grid.Row="3" Grid.Column="1"
                            Content="Issue Stock"
                            Width="120"
                            Margin="0,12,0,0"
                            HorizontalAlignment="Left"
                            Command="{Binding IssueStockCommand}"
                            IsEnabled="{Binding CanIssueStock}"/>
				</Grid>
			</GroupBox>

			<!-- ================= ISSUED STOCK HISTORY ================= -->
			<GroupBox Grid.Row="4"
                      Header="Issued Stock History"
                      Margin="0,30,0,0">

				<DataGrid ItemsSource="{Binding IssuedStockHistory}"
                          AutoGenerateColumns="False"
                          IsReadOnly="True"
                          CanUserAddRows="False"
                          Margin="5">

					<DataGrid.Columns>
						<DataGridTextColumn Header="Issued On"
                                            Binding="{Binding IssuedOn, StringFormat=\{0:yyyy-MM-dd HH:mm\}}"
                                            Width="140"/>
						<DataGridTextColumn Header="Stock Item"
                                            Binding="{Binding Notes}"
                                            Width="*"/>
						<DataGridTextColumn Header="Quantity"
                                            Binding="{Binding Quantity}"
                                            Width="100"/>
						<DataGridTextColumn Header="Issued By"
                                            Binding="{Binding IssuedBy}"
                                            Width="140"/>
						<DataGridTextColumn Header="Notes"
                                            Binding="{Binding Notes}"
                                            Width="*"/>
					</DataGrid.Columns>
				</DataGrid>
			</GroupBox>

		</Grid>
	</ScrollViewer>
</Window>
