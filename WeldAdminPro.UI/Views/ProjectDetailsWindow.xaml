<Window x:Class="WeldAdminPro.UI.Views.ProjectDetailsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Project Details"
        Width="600"
        Height="800"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize">

	<ScrollViewer VerticalScrollBarVisibility="Auto">
		<Grid Margin="20">

			<!-- ================= MAIN ROWS ================= -->
			<Grid.RowDefinitions>
				<RowDefinition Height="Auto"/>
				<!-- Header -->
				<RowDefinition Height="Auto"/>
				<!-- Form -->
				<RowDefinition Height="Auto"/>
				<!-- Buttons -->
				<RowDefinition Height="Auto"/>
				<!-- Issue Stock -->
				<RowDefinition Height="Auto"/>
				<!-- Issued History -->
				<RowDefinition Height="Auto"/>
				<!-- Return Stock -->
			</Grid.RowDefinitions>

			<!-- ================= HEADER ================= -->
			<Grid Grid.Row="0" Margin="0,0,0,15">
				<Grid.ColumnDefinitions>
					<ColumnDefinition Width="120"/>
					<ColumnDefinition Width="*"/>
					<ColumnDefinition Width="120"/>
					<ColumnDefinition Width="*"/>
				</Grid.ColumnDefinitions>

				<TextBlock Text="Job Number" FontWeight="Bold"/>
				<TextBox Grid.Column="1"
                         Text="{Binding Project.JobNumber}"
                         IsReadOnly="True"
                         Background="#EEE"/>

				<TextBlock Grid.Column="2"
                           Text="Status"
                           FontWeight="Bold"/>
				<ComboBox Grid.Column="3"
                          ItemsSource="{Binding Statuses}"
                          SelectedItem="{Binding Status}"
                          Height="26"/>
			</Grid>

			<!-- ================= PROJECT FORM ================= -->
			<Grid Grid.Row="1">
				<Grid.ColumnDefinitions>
					<ColumnDefinition Width="120"/>
					<ColumnDefinition Width="*"/>
					<ColumnDefinition Width="20"/>
					<ColumnDefinition Width="120"/>
					<ColumnDefinition Width="*"/>
				</Grid.ColumnDefinitions>

				<Grid.RowDefinitions>
					<RowDefinition Height="Auto"/>
					<RowDefinition Height="Auto"/>
					<RowDefinition Height="Auto"/>
					<RowDefinition Height="Auto"/>
					<RowDefinition Height="Auto"/>
					<RowDefinition Height="Auto"/>
					<RowDefinition Height="Auto"/>
					<RowDefinition Height="Auto"/>
				</Grid.RowDefinitions>

				<TextBlock Grid.Row="0" Text="Project Name"/>
				<TextBox Grid.Row="0" Grid.Column="1" Grid.ColumnSpan="4"
                         Text="{Binding Project.ProjectName}"
                         IsEnabled="{Binding IsEditable}"/>

				<TextBlock Grid.Row="1" Text="Client" Margin="0,6,0,0"/>
				<TextBox Grid.Row="1" Grid.Column="1" Grid.ColumnSpan="4"
                         Margin="0,6,0,0"
                         Text="{Binding Project.Client}"
                         IsEnabled="{Binding IsEditable}"/>

				<TextBlock Grid.Row="2" Text="Client Rep" Margin="0,6,0,0"/>
				<TextBox Grid.Row="2" Grid.Column="1" Grid.ColumnSpan="4"
                         Margin="0,6,0,0"
                         Text="{Binding Project.ClientRepresentative}"
                         IsEnabled="{Binding IsEditable}"/>

				<TextBlock Grid.Row="3" Text="Quote #" Margin="0,6,0,0"/>
				<TextBox Grid.Row="3" Grid.Column="1"
                         Margin="0,6,0,0"
                         Text="{Binding Project.QuoteNumber}"
                         IsEnabled="{Binding IsEditable}"/>

				<TextBlock Grid.Row="3" Grid.Column="3" Text="Order #" Margin="0,6,0,0"/>
				<TextBox Grid.Row="3" Grid.Column="4"
                         Margin="0,6,0,0"
                         Text="{Binding Project.OrderNumber}"
                         IsEnabled="{Binding IsEditable}"/>

				<TextBlock Grid.Row="4" Text="Amount (R)" Margin="0,6,0,0"/>
				<TextBox Grid.Row="4" Grid.Column="1"
                         Margin="0,6,0,0"
                         Text="{Binding Project.Amount}"
                         IsEnabled="{Binding IsEditable}"/>

				<TextBlock Grid.Row="5" Text="Material" Margin="0,6,0,0"/>
				<TextBox Grid.Row="5" Grid.Column="1"
                         Margin="0,6,0,0"
                         Text="{Binding Project.Material}"
                         IsEnabled="{Binding IsEditable}"/>

				<TextBlock Grid.Row="5" Grid.Column="3" Text="Assigned To" Margin="0,6,0,0"/>
				<TextBox Grid.Row="5" Grid.Column="4"
                         Margin="0,6,0,0"
                         Text="{Binding Project.AssignedTo}"
                         IsEnabled="{Binding IsEditable}"/>

				<TextBlock Grid.Row="6" Text="Start Date" Margin="0,6,0,0"/>
				<DatePicker Grid.Row="6" Grid.Column="1"
                            Margin="0,6,0,0"
                            SelectedDate="{Binding Project.StartDate}"
                            IsEnabled="{Binding IsEditable}"/>

				<TextBlock Grid.Row="6" Grid.Column="3" Text="End Date" Margin="0,6,0,0"/>
				<DatePicker Grid.Row="6" Grid.Column="4"
                            Margin="0,6,0,0"
                            SelectedDate="{Binding Project.EndDate}"
                            IsEnabled="{Binding IsEditable}"/>

				<CheckBox Grid.Row="7"
                          Content="Invoiced"
                          Margin="0,10,0,0"
                          IsChecked="{Binding Project.IsInvoiced}"
                          IsEnabled="{Binding IsEditable}"/>

				<TextBox Grid.Row="7" Grid.Column="4"
                         Margin="0,10,0,0"
                         Text="{Binding Project.InvoiceNumber}"
                         IsEnabled="{Binding Project.IsInvoiced}"/>
			</Grid>

			<!-- ================= BUTTONS ================= -->
			<StackPanel Grid.Row="2"
                        Orientation="Horizontal"
                        HorizontalAlignment="Right"
                        Margin="0,20,0,0">
				<Button Content="Save"
                        Width="100"
                        Margin="0,0,10,0"
                        Command="{Binding SaveCommand}"/>
				<Button Content="Cancel"
                        Width="100"
                        Command="{Binding CancelCommand}"/>
			</StackPanel>

			<!-- ================= ISSUE STOCK ================= -->
			<GroupBox Grid.Row="3"
                      Header="Issue Stock to Project"
                      Margin="0,20,0,0">
				<Grid Margin="10">
					<Grid.ColumnDefinitions>
						<ColumnDefinition Width="120"/>
						<ColumnDefinition Width="*"/>
					</Grid.ColumnDefinitions>
					<Grid.RowDefinitions>
						<RowDefinition Height="Auto"/>
						<RowDefinition Height="Auto"/>
						<RowDefinition Height="Auto"/>
						<RowDefinition Height="Auto"/>
					</Grid.RowDefinitions>

					<TextBlock Text="Stock Item"/>
					<ComboBox Grid.Column="1"
                              ItemsSource="{Binding StockItems}"
                              SelectedItem="{Binding SelectedStockItem}"
                              DisplayMemberPath="Description"/>

					<TextBlock Grid.Row="1" Text="Quantity" Margin="0,6,0,0"/>
					<TextBox Grid.Row="1" Grid.Column="1"
                             Margin="0,6,0,0"
                             Text="{Binding IssueQuantity}"/>

					<TextBlock Grid.Row="2" Grid.Column="1"
                               Foreground="Gray"
                               Text="{Binding AvailableQuantity, StringFormat=Available: {0}}"/>

					<TextBlock Grid.Row="3" Text="Issued By" Margin="0,6,0,0"/>
					<TextBox Grid.Row="3" Grid.Column="1"
                             Margin="0,6,269,0"
                             Text="{Binding IssuedBy}"/>

					<Button Grid.Row="3" Grid.Column="1"
                            Content="Issue Stock"
                            Width="120"
                            Margin="165,10,123,0"
                            Command="{Binding IssueStockCommand}"
                            IsEnabled="{Binding CanIssueStock}"/>
				</Grid>
			</GroupBox>

			<!-- ================= ISSUED HISTORY ================= -->
			<GroupBox Grid.Row="4"
                      Header="Issued Stock History"
                      Margin="0,20,0,0">
				<DataGrid ItemsSource="{Binding IssuedStockHistory}"
                          AutoGenerateColumns="False"
                          IsReadOnly="True"
                          CanUserAddRows="False">
					<DataGrid.Columns>
						<DataGridTextColumn Header="Date"
                                            Binding="{Binding IssuedOn, StringFormat=\{0:yyyy-MM-dd HH:mm\}}"
                                            Width="150"/>
						<DataGridTextColumn Header="Item" Binding="{Binding Notes}" Width="*"/>
						<DataGridTextColumn Header="Qty" Binding="{Binding Quantity}" Width="80"/>
						<DataGridTextColumn Header="By" Binding="{Binding IssuedBy}" Width="120"/>
					</DataGrid.Columns>
				</DataGrid>
			</GroupBox>

			<!-- ================= RETURN STOCK ================= -->
			<GroupBox Grid.Row="5"
                      Header="Return Stock"
                      Margin="0,20,0,0">
				<Grid Margin="10">
					<Grid.ColumnDefinitions>
						<ColumnDefinition Width="120"/>
						<ColumnDefinition Width="*"/>
					</Grid.ColumnDefinitions>
					<Grid.RowDefinitions>
						<RowDefinition Height="Auto"/>
						<RowDefinition Height="Auto"/>
						<RowDefinition Height="Auto"/>
						<RowDefinition Height="Auto"/>
					</Grid.RowDefinitions>

					<TextBlock Text="Issued Item"/>
					<ComboBox Grid.Column="1"
                              ItemsSource="{Binding ReturnableIssuedItems}"
                              SelectedItem="{Binding SelectedIssuedUsage}"
                              DisplayMemberPath="Notes"/>

					<TextBlock Grid.Row="1" Text="Return Qty" Margin="0,6,0,0"/>
					<TextBox Grid.Row="1" Grid.Column="1"
                             Margin="0,6,0,0"
                             Text="{Binding ReturnQuantity}"/>

					<TextBlock Grid.Row="2" Grid.Column="1"
                               Foreground="Gray"
                               Text="{Binding RemainingIssuedBalance,
                               StringFormat=Remaining issued: {0}}"/>

					<Button Grid.Row="3" Grid.Column="1"
                            Content="Return Stock"
                            Width="120"
                            Margin="0,10,0,0"
                            Command="{Binding ReturnStockCommand}"
                            IsEnabled="{Binding CanReturnStock}"/>
				</Grid>
			</GroupBox>

		</Grid>
	</ScrollViewer>
</Window>
